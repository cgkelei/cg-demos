<Effect name="LightTextured">
<Shader stage="Vertex" name="VS" entry="main">
<![CDATA[
#version 330

in vec3 Position;
in vec3 Normal;
in vec2 Tex;

out vec3 oNormal;
out vec3 oLightDir;
out vec2 oTex;

uniform mat4 World;
uniform mat4 ViewProj;

vec3 LightPos = vec3(100, 100, 100);

void main()
{
	// calculate world poistion
	vec4 worldPos = vec4(Position, 1.0) * World;
	
	oNormal = Normal * mat3(World);
	oLightDir = LightPos - vec3(worldPos);
	oTex = Tex;
	
    gl_Position = worldPos * ViewProj;
}

]]>
</Shader>
<Shader stage="Pixel" name="PS" entry="main">
<![CDATA[
#version 330

in vec3 oNormal;
in vec3 oLightDir;
in vec2 oTex;

out vec4 FragColor;
 
uniform sampler2D DiffuseMap; 

void main()
{
	vec3 normal = normalize(oNormal);
	vec3 light = normalize(oLightDir);
	
	float diffuseFactor = max( dot(normal, light), 0 );
	vec3 diffuse = vec3( texture(DiffuseMap, oTex) );
	
	FragColor = vec4(diffuse, 1.0);
}

]]>
</Shader>

<Technique name="PhongLight">
	<Pass name="p0">
		<State name="CullMode" value="Back"/>
		<VertexShader name="VS"/>
		<PixelShader name="PS"/>
	</Pass>
</Technique>
</Effect>